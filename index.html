<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>코디 추천 — 확장 MVP (피부톤 12시즌)</title>
  <style>
    :root { --gap: 12px; --radius: 14px; --focus: 2px solid #111; }
    * { box-sizing: border-box; }
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", sans-serif; margin:0; background:#f7f7fb; color:#111; }
    .wrap { max-width: 980px; margin: 32px auto; padding: 0 16px; }
    header { display:flex; gap:var(--gap); flex-wrap:wrap; align-items:center; justify-content:space-between; margin-bottom: 16px; }
    h1 { font-size: clamp(20px, 4vw, 28px); margin:0; }
    .lang { display:flex; gap:8px; }
    .lang button { padding:8px 10px; border:1px solid #d8d8e1; background:#fff; border-radius:10px; }
    .card { background:#fff; border:1px solid #e9e9ef; border-radius: var(--radius); padding: 18px; box-shadow: 0 2px 8px rgba(0,0,0,.04); }
    .grid { display:grid; grid-template-columns: repeat(12, 1fr); gap: var(--gap); }
    .col-4 { grid-column: span 4; } .col-6{ grid-column: span 6; } .col-12{ grid-column: span 12; }
    @media (max-width: 720px){ .col-4, .col-6 { grid-column: span 12; } }
    label { display:block; font-weight:600; margin-bottom:6px; }
    select, input[type="number"], button { width:100%; padding:10px 12px; border-radius: 10px; border:1px solid #d8d8e1; background:#fff; }
    input:focus, select:focus, button:focus { outline: var(--focus); outline-offset: 2px; }
    button { cursor:pointer; font-weight:700; }
    .primary { background:#111; color:#fff; border-color:#111; }
    .result { margin-top: 18px; display:none; }
    .result h3 { margin: 0 0 8px; }
    .tags { display:flex; flex-wrap:wrap; gap:8px; margin-top:10px;}
    .tag { border:1px solid #ddd; border-radius:999px; padding:6px 10px; font-size: 13px; background:#fafafa; }
    .tip { padding:12px; border-left:4px solid #111; background:#fafafa; border-radius:8px; }
    .muted { color:#666; font-size: 13px; }
    .hr { height:1px; background:#eee; margin:14px 0; }
    .pill { display:inline-flex; align-items:center; gap:8px; border:1px solid #ddd; padding:8px 10px; border-radius:999px; }
    .row { display:flex; gap:var(--gap); flex-wrap:wrap; align-items:center; }
    .heart { cursor:pointer; user-select:none; }
    .toast { position: fixed; left:50%; transform:translateX(-50%); bottom:24px; background:#111; color:#fff; padding:10px 14px; border-radius:12px; display:none; }
    footer { margin: 22px 0 40px; color:#666; font-size:13px; }
    .hidden { display:none !important; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1 id="title" aria-live="polite">나이·성별·체형·상황별 코디 추천</h1>
      <div class="lang" role="group" aria-label="언어 선택">
        <button type="button" data-lang="ko" aria-pressed="true">한국어</button>
        <button type="button" data-lang="en" aria-pressed="false">English</button>
        <button type="button" data-lang="ja" aria-pressed="false">日本語</button>
      </div>
    </header>

    <section class="card" aria-labelledby="form-title">
      <div class="row" style="justify-content:space-between; margin-bottom:6px;">
        <h2 id="form-title" style="margin:0;">기본 선택</h2>
        <!-- 실험 배지 문구 삭제 요청 → 숨김 -->
        <span id="variantBadge" class="hidden" aria-hidden="true"></span>
      </div>

      <div class="grid" role="form">
        <!-- 나이/성별 -->
        <div class="col-4">
          <label for="age">나이대</label>
          <select id="age" aria-describedby="ageHelp">
            <option value="10">10대</option>
            <option value="20">20대</option>
            <option value="30">30대</option>
            <option value="40">40대</option>
            <option value="50">50대</option>
          </select>
          <div id="ageHelp" class="muted">대략적인 스타일 무드에 사용</div>
        </div>
        <div class="col-4">
          <label for="gender">성별</label>
          <select id="gender">
            <option value="female">여성</option>
            <option value="male">남성</option>
            <option value="unisex">유니섹스</option>
          </select>
        </div>

        <!-- 정밀 체형 입력 -->
        <div class="col-4">
          <label>신체 정보 <span class="muted">(선택)</span></label>
          <div class="row">
            <span class="pill" aria-label="키 입력">
              <span>키</span>
              <input id="height" type="number" inputmode="decimal" min="130" max="220" placeholder="cm" aria-label="키 (cm)" style="width:90px">
              <span class="muted">cm</span>
            </span>
            <span class="pill" aria-label="몸무게 입력">
              <span>몸무게</span>
              <input id="weight" type="number" inputmode="decimal" min="30" max="200" placeholder="kg" aria-label="몸무게 (kg)" style="width:90px">
              <span class="muted">kg</span>
            </span>
          </div>
          <div class="row" style="margin-top:8px">
            <span class="pill">
              <span>허리</span>
              <input id="waist" type="number" inputmode="decimal" min="50" max="150" placeholder="cm" aria-label="허리 둘레 (cm)" style="width:90px">
              <span class="muted">cm</span>
            </span>
            <span class="pill">
              <span>어깨</span>
              <input id="shoulder" type="number" inputmode="decimal" min="30" max="70" placeholder="cm" aria-label="어깨 너비 (cm)" style="width:90px">
              <span class="muted">cm</span>
            </span>
          </div>
          <div class="muted" id="autoShapeNote" aria-live="polite" style="margin-top:6px"></div>
        </div>

        <!-- 상황/계절 -->
        <div class="col-6">
          <label for="occasion">상황</label>
          <select id="occasion">
            <option value="office">출근/오피스</option>
            <option value="date">데이트</option>
            <option value="travel">여행/주말</option>
            <option value="formal">격식/행사</option>
            <option value="guest">하객/모임</option>
          </select>
        </div>
        <div class="col-6">
          <label for="season">계절</label>
          <select id="season">
            <option value="spring">봄</option>
            <option value="summer">여름</option>
            <option value="autumn">가을</option>
            <option value="winter">겨울</option>
          </select>
        </div>

        <!-- 피부톤 12시즌 -->
        <div class="col-6">
          <label for="skinTone">피부톤 (12시즌)</label>
          <select id="skinTone">
            <optgroup label="봄(Spring)">
              <option value="springLight">봄 라이트</option>
              <option value="springWarm">봄 트루(웜)</option>
              <option value="springBright">봄 브라이트</option>
            </optgroup>
            <optgroup label="여름(Summer)">
              <option value="summerLight">여름 라이트</option>
              <option value="summerCool">여름 트루(쿨)</option>
              <option value="summerSoft">여름 소프트</option>
            </optgroup>
            <optgroup label="가을(Autumn)">
              <option value="autumnSoft">가을 소프트</option>
              <option value="autumnWarm">가을 트루(웜)</option>
              <option value="autumnDeep">가을 딥</option>
            </optgroup>
            <optgroup label="겨울(Winter)">
              <option value="winterDeep">겨울 딥</option>
              <option value="winterCool">겨울 트루(쿨)</option>
              <option value="winterBright">겨울 브라이트</option>
            </optgroup>
          </select>
        </div>

        <!-- 실행 버튼 -->
        <div class="col-12 row" style="margin-top: 4px;">
          <button class="primary" id="recommend"></button>
          <button id="save">현재 설정 저장</button>
          <button id="reset">초기화</button>
        </div>
        <!-- Enter 안내 문구 삭제 요청 → 요소 자체 제거 -->
      </div>

      <div class="hr" role="separator" aria-hidden="true"></div>

      <div class="result" id="result" aria-live="polite">
        <h3>추천 결과</h3>
        <div class="tip" id="summary"></div>
        <div class="muted" id="benefit"></div><!-- 장점 한 줄 -->
        <div class="tags" id="tags"></div>
        <div class="row" style="margin-top:10px">
          <span class="heart" id="likeBtn" role="button" aria-pressed="false" aria-label="추천 즐겨찾기">🤍 즐겨찾기</span>
          <!-- 데모 주석문 삭제 요청 → 숨김 -->
          <span class="muted hidden" id="note" aria-hidden="true"></span>
        </div>
      </div>
    </section>

    <!-- 개인화 — 최근 추천 & 즐겨찾기 -->
    <section class="card" style="margin-top:16px" aria-labelledby="saved-title">
      <h2 id="saved-title" style="margin:0 0 8px">내 저장 목록</h2>
      <div class="grid">
        <div class="col-6">
          <h3 style="margin:4px 0">최근 추천</h3>
          <ul id="recentList" aria-live="polite"></ul>
        </div>
        <div class="col-6">
          <h3 style="margin:4px 0">즐겨찾기</h3>
          <ul id="favList" aria-live="polite"></ul>
        </div>
      </div>
    </section>

    <footer>
      <!-- 푸터 문구 삭제 요청 → 빈 상태 유지 -->
    </footer>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    // ===== 다국어(i18n) =====
    const I18N = {
      ko: {
        title:"나이·성별·체형·상황별 코디 추천",
        ctaA:"코디 추천 받기",
        ctaB:"내 코디 보기",
        saved:"저장되었습니다",
        cleared:"초기화 완료",
        liked:"즐겨찾기에 추가했어요",
        unliked:"즐겨찾기에서 제거했어요"
      },
      en: {
        title:"Outfits by Age · Gender · Body Type · Occasion",
        ctaA:"Get Suggestions",
        ctaB:"View My Outfit",
        saved:"Saved",
        cleared:"Reset done",
        liked:"Added to favorites",
        unliked:"Removed from favorites"
      },
      ja: {
        title:"年齢・性別・体型・シーン別コーデ",
        ctaA:"コーデを見る",
        ctaB:"マイコーデ表示",
        saved:"保存しました",
        cleared:"リセット完了",
        liked:"お気に入りに追加",
        unliked:"お気に入りから削除"
      }
    };
    let LANG = localStorage.getItem("lang") || "ko";
    function t(key){ return (I18N[LANG] && I18N[LANG][key]) || I18N["ko"][key] || key; }
    function applyLang(){
      document.getElementById("title").textContent = t("title");
      document.getElementById("recommend").textContent = EXP.variant==="A"? t("ctaA"): t("ctaB");
      document.querySelectorAll('.lang button').forEach(b=> b.setAttribute('aria-pressed', b.dataset.lang===LANG ? 'true':'false'));
      document.documentElement.lang = LANG;
    }
    document.querySelectorAll('.lang button').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        LANG = btn.dataset.lang; localStorage.setItem("lang", LANG); applyLang();
      });
    });

    // ===== A/B 테스트 (배지는 숨겨둠, 기능만 유지) =====
    const EXP = (()=> {
      const key="ab_variant";
      const existing = localStorage.getItem(key);
      const variant = existing || (Math.random()<0.5 ? "A":"B");
      localStorage.setItem(key, variant);
      return { key, variant };
    })();

    function logEvent(name, data={}){
      const payload = { ts: Date.now(), name, variant: EXP.variant, lang: LANG, ...data };
      console.log("[analytics]", payload);
    }

    // ===== 체형 자동 분류 =====
    function autoBodyType(){
      const h = parseFloat(height.value);
      const w = parseFloat(weight.value);
      const waistV = parseFloat(waist.value);
      const shoulderV = parseFloat(shoulder.value);

      let type = null;
      if(!isNaN(h) && !isNaN(w)){
        const bmi = w / Math.pow(h/100, 2);
        if(bmi >= 27) type = "round";
        else if(bmi <= 19) type = "rectangle";
      }
      if(!isNaN(shoulderV) && !isNaN(waistV)){
        const ratio = shoulderV / waistV;
        if(ratio >= 1.25) type = "inverted";
        else if(ratio <= 0.95) type = "triangle";
        else if(ratio >= 1.05 && ratio <= 1.15 && !type) type = "rectangle";
      }
      if(!isNaN(height.value)){
        if(h <= 160) type = type || "petite";
        if(h >= 185) type = type || "tall";
      }

      const msg = type
        ? `자동 추정 체형: ${prettyShape(type)} (입력값 기반)`
        : `입력값이 부족해요. 기본 체형 로직으로 추천합니다.`;
      autoShapeNote.textContent = msg;
      return type;
    }
    function prettyShape(s){
      const map={triangle:"삼각형", inverted:"역삼각형", rectangle:"직사각형", hourglass:"모래시계", round:"라운드", petite:"키 작은 체형", tall:"키 큰 체형"};
      return map[s]||s;
    }

    // ===== 기본 규칙 =====
    const baseRules = {
      "10": {
        male:   baseRule("스트리트/스포티", ["루즈핏 후드","카고팬츠","스니커즈","캡모자"]),
        female: baseRule("캐주얼/러블리", ["크롭 니트","플리츠 스커트","스니커즈","숄더백"]),
        unisex: baseRule("베이직 캐주얼", ["그래픽 티","스트레이트 데님","캔버스 슈즈","바시티 자켓"])
      },
      "20": {
        male:   baseRule("미니멀 캐주얼", ["화이트 셔츠","슬림핏 슬랙스","첼시부츠","가죽벨트"]),
        female: baseRule("시크/페미닌", ["슬립 원피스","오버핏 자켓","앵클부츠","크로스백"]),
        unisex: baseRule("데일리 미니멀", ["니트 폴로","와이드 데님","로퍼","토트백"])
      },
      "30": {
        male:   baseRule("세미오피스", ["옥스퍼드 셔츠","테이퍼드 슬랙스","더비슈즈","트렌치"]),
        female: baseRule("모던 엘레강스", ["블라우스","머메이드 스커트","펌프스","트렌치"]),
        unisex: baseRule("정갈한 데일리", ["크루넥 니트","치노 팬츠","로퍼","코트"])
      },
      "40": {
        male:   baseRule("클래식 & 편안함", ["니트 가디건","크롭트 슬랙스","로퍼","가죽시계"]),
        female: baseRule("절제된 포멀", ["셔츠 원피스","미들 힐","니트 가디건","코트"]),
        unisex: baseRule("뉴트럴 톤", ["캐시미어 니트","와이드 슬랙스","콤피 스니커즈","울코트"])
      },
      "50": {
        male:   baseRule("품격 있는 베이직", ["니트 폴로","울 슬랙스","로퍼","스카프"]),
        female: baseRule("우아한 클래식", ["실크 블라우스","A라인 스커트","로우힐","숄"]),
        unisex: baseRule("심플 럭스", ["카디건","테일러드 팬츠","컴포트 슈즈","롱코트"])
      }
    };

    // ===== 조정 규칙 =====
    const shapeAdjust = {
      triangle:  ["어두운 하의","밝은 상의","어깨 라인 강조","일자/세미와이드"],
      inverted:  ["어두운 상의","밝은 하의","V넥/깊은 네크라인","테이퍼드/슬림"],
      rectangle: ["허리선 강조","벨트/핀턱","레이어드로 볼륨","세미오버"],
      hourglass: ["허리 라인 유지","크롭/세미크롭 상의","하이웨이스트","슬림 스트레이트"],
      round:     ["수직 실루엣","짙은 톤 통일","V넥/롱아우터","스트레이트/부츠컷"],
      petite:    ["세로선 강조","크롭 상의","하이웨이스트","과한 오버핏 지양"],
      tall:      ["가로선/레이어드","롱코트/롱가디건","와이드/플레어","낮은 대비톤"]
    };
    const occasionAdjust = {
      office: ["셔츠/블라우스","테일러드","슬랙스","로퍼/펌프스"],
      date: ["미디/슬림 실루엣","소프트 텍스처","포인트 컬러"],
      travel: ["컴포트/신축성","스니커즈","크로스백","아우터 레이어드"],
      formal: ["모노톤/다크톤","미니멀 디테일","정장핏"],
      guest: ["세미포멀","원피스/자켓","적절한 광택감"]
    };
    const seasonAdjust = {
      spring: ["라이트 아우터","코튼/린넨","밝은 뉴트럴"],
      summer: ["통기성 소재","반팔/슬리브리스","밝은 쿨톤"],
      autumn: ["가디건/트렌치","니트 텍스처","카멜/브라운"],
      winter: ["울/패딩","터틀넥","부츠","하이컨트라스트"]
    };

    // 피부톤(12시즌) 색상 포인트
    const skinToneAdjust = {
      // Spring
      springLight:  ["피치","라이트 코랄","아쿠아"],
      springWarm:   ["살몬 핑크","애프리콧","골드"],
      springBright: ["밝은 터콰이즈","라임","브라이트 코랄"],
      // Summer
      summerLight:  ["라이트 라일락","민트","소프트 블루"],
      summerCool:   ["더스티 로즈","라벤더","실버"],
      summerSoft:   ["그레이시 블루","말린장미","세이지"],
      // Autumn
      autumnSoft:   ["카키","웜 그레이","모스그린"],
      autumnWarm:   ["머스타드","카멜","테라코타"],
      autumnDeep:   ["딥 올리브","초콜릿 브라운","버건디"],
      // Winter
      winterDeep:   ["딥 네이비","와인","차콜"],
      winterCool:   ["쥬얼톤 블루","아이시 핑크","실버"],
      winterBright: ["퓨어 화이트","휘시아(핫핑크)","코발트"]
    };

    function baseRule(summary, tags){ return { summary, tags }; }
    function dedup(arr){ return [...new Set(arr)]; }
    function prettyOccasion(v){ return {office:"출근", date:"데이트", travel:"여행", formal:"격식", guest:"하객"}[v]||v; }
    function prettySeason(v){ return {spring:"봄", summer:"여름", autumn:"가을", winter:"겨울"}[v]||v; }

    // ===== 장점 문구(≤30자) =====
    function benefitText({autoShape, occasion, season, skinTone}){
      // 우선순위: 체형 → 계절/상황 → 피부톤 포인트
      const byShape = {
        triangle:"상하체 비율 보정, 슬림해 보임",
        inverted:"상체 부각 완화, 균형 잡힌 실루엣",
        rectangle:"허리선 강조로 비율 개선",
        hourglass:"허리라인 살려 더 균형 있게",
        round:"수직 실루엣로 날씬해 보임",
        petite:"세로선/하이웨이스트로 길어 보임",
        tall:"레이어드로 안정적 비율 연출"
      }[autoShape];
      if(byShape) return byShape.slice(0,30);

      const byOcc = {
        office:"단정·전문적 인상 강화",
        date:"부드럽고 호감도 높은 무드",
        travel:"편안함과 활동성을 동시에",
        formal:"격식과 세련미를 모두 잡음",
        guest:"과하지 않게 품격 있는 인상"
      }[occasion];
      if(byOcc) return byOcc.slice(0,30);

      const bySeason = {
        spring:"밝고 산뜻한 이미지 연출",
        summer:"시원하고 청량한 인상",
        autumn:"자연스러운 깊이감 강조",
        winter:"선명한 대비로 또렷한 인상"
      }[season];
      if(bySeason) return bySeason.slice(0,30);

      // 피부톤 키워드
      const byTone = {
        springLight:"맑고 화사한 톤업 효과",
        springWarm:"웜광채·생기 있는 인상",
        springBright:"선명한 컬러로 활력 업",
        summerLight:"부드럽고 깨끗한 무드",
        summerCool:"차분하고 고급스러운 쿨톤",
        summerSoft:"소프트 톤으로 자연스러움",
        autumnSoft:"웜 뉴트럴로 안정감",
        autumnWarm:"리치한 웜톤으로 생기",
        autumnDeep:"딥 컬러로 존재감 강화",
        winterDeep:"강한 대비로 카리스마",
        winterCool:"차가운 쥬얼톤으로 선명함",
        winterBright:"고명도 컬러로 또렷함"
      }[skinTone];
      return (byTone || "당신에게 가장 잘 맞는 조합").slice(0,30);
    }

    function recommend({age, gender, autoShape, occasion, season, skinTone}){
      const base = (baseRules[age] && baseRules[age][gender]) || baseRule("베이직 데일리", ["티셔츠","데님","스니커즈"]);
      const adjustShape = shapeAdjust[autoShape] || [];
      const adjustOcc = occasionAdjust[occasion] || [];
      const adjustSeason = seasonAdjust[season] || [];
      const adjustSkin = skinToneAdjust[skinTone] || [];

      const summary =
        `무드: ${base.summary} · 체형: ${autoShape? prettyShape(autoShape):"기본"} · 상황: ${prettyOccasion(occasion)} · 계절: ${prettySeason(season)} · 피부톤: ${skinTone}`;
      const tags = dedup([...base.tags, ...adjustShape, ...adjustOcc, ...adjustSeason, ...adjustSkin]).slice(0, 12);

      return { summary, tags };
    }

    // ===== 키보드 접근성 =====
    document.addEventListener('keydown',(e)=>{
      if(e.key==="Enter"){ document.getElementById("recommend").click(); }
    });

    // ===== 저장/개인화 =====
    const STORAGE = {
      saveSettings(data){ localStorage.setItem("settings", JSON.stringify(data)); },
      loadSettings(){ try { return JSON.parse(localStorage.getItem("settings")||"null"); } catch(e){return null;} },
      pushRecent(item){
        const arr = JSON.parse(localStorage.getItem("recent")||"[]");
        arr.unshift(item); if(arr.length>10) arr.pop();
        localStorage.setItem("recent", JSON.stringify(arr));
      },
      getRecent(){ return JSON.parse(localStorage.getItem("recent")||"[]"); },
      toggleFav(item){
        const arr = new Map(JSON.parse(localStorage.getItem("favs")||"[]"));
        const key = item.key;
        if(arr.has(key)) arr.delete(key); else arr.set(key, item);
        localStorage.setItem("favs", JSON.stringify([...arr.entries()]));
        return arr.has(key);
      },
      getFavs(){ return new Map(JSON.parse(localStorage.getItem("favs")||"[]")); }
    };

    function renderLists(){
      const recent = STORAGE.getRecent();
      const favs = STORAGE.getFavs();
      recentList.innerHTML = "";
      favList.innerHTML = "";
      recent.forEach(r=>{
        const li = document.createElement("li");
        li.textContent = `${r.summary}`;
        recentList.appendChild(li);
      });
      favs.forEach(v=>{
        const li = document.createElement("li");
        li.textContent = `${v.summary}`;
        favList.appendChild(li);
      });
    }

    // ===== UI 바인딩 =====
    const age = document.getElementById("age");
    const gender = document.getElementById("gender");
    const height = document.getElementById("height");
    const weight = document.getElementById("weight");
    const waist = document.getElementById("waist");
    const shoulder = document.getElementById("shoulder");
    const occasion = document.getElementById("occasion");
    const season = document.getElementById("season");
    const skinTone = document.getElementById("skinTone");
    const res = document.getElementById("result");
    const summaryEl = document.getElementById("summary");
    const benefitEl = document.getElementById("benefit");
    const tagsEl = document.getElementById("tags");
    const likeBtn = document.getElementById("likeBtn");
    const ctaBtn = document.getElementById("recommend");
    const saveBtn = document.getElementById("save");
    const resetBtn = document.getElementById("reset");
    const toast = document.getElementById("toast");
    const recentList = document.getElementById("recentList");
    const favList = document.getElementById("favList");

    function toastMsg(msg){
      toast.textContent = msg;
      toast.style.display = "block";
      setTimeout(()=> toast.style.display="none", 1300);
    }

    [height, weight, waist, shoulder].forEach(i=> i.addEventListener('input', autoBodyType));

    function currentInput(){
      const inferredShape = autoBodyType();
      return {
        age: age.value,
        gender: gender.value,
        autoShape: inferredShape || "rectangle",
        occasion: occasion.value,
        season: season.value,
        skinTone: skinTone.value
      };
    }

    function runRecommend(){
      const input = currentInput();
      const { summary, tags } = recommend(input);
      summaryEl.textContent = summary;
      benefitEl.textContent = benefitText(input); // <= 장점 한 줄 (≤30자)
      tagsEl.innerHTML = "";
      tags.forEach(t=>{
        const span = document.createElement("span");
        span.className = "tag"; span.textContent = t;
        tagsEl.appendChild(span);
      });
      res.style.display = "block";

      STORAGE.pushRecent({ key: String(Date.now()), summary });
      renderLists();
      logEvent("recommend_click", input);
    }

    ctaBtn.addEventListener('click', runRecommend);
    likeBtn.addEventListener('click', ()=>{
      const item = { key: "fav:"+summaryEl.textContent.slice(0,80), summary: summaryEl.textContent };
      const nowLiked = STORAGE.toggleFav(item);
      likeBtn.textContent = nowLiked ? "💖 즐겨찾기" : "🤍 즐겨찾기";
      likeBtn.setAttribute("aria-pressed", nowLiked ? "true":"false");
      toastMsg(nowLiked ? t("liked") : t("unliked"));
      renderLists();
      logEvent("favorite_toggle", { liked: nowLiked });
    });

    saveBtn.addEventListener('click', ()=>{
      const s = currentInput();
      STORAGE.saveSettings(s);
      toastMsg(t("saved"));
      logEvent("save_settings", s);
    });

    resetBtn.addEventListener('click', ()=>{
      age.value = "10"; gender.value = "female";
      [height,weight,waist,shoulder].forEach(i=> i.value = "");
      occasion.value = "office"; season.value="spring";
      skinTone.value="springLight";
      res.style.display = "none"; summaryEl.textContent=""; tagsEl.innerHTML=""; benefitEl.textContent="";
      autoShapeNote.textContent="";
      likeBtn.textContent="🤍 즐겨찾기"; likeBtn.setAttribute("aria-pressed","false");
      toastMsg(t("cleared"));
      logEvent("reset");
    });

    // 초기 로드
    (function init(){
      applyLang();
      const s = STORAGE.loadSettings();
      if(s){
        age.value = s.age || "10";
        gender.value = s.gender || "female";
        occasion.value = s.occasion || "office";
        season.value = s.season || "spring";
        skinTone.value = s.skinTone || "springLight";
      }
      autoBodyType();
      renderLists();
    })();
  </script>
</body>
</html>
